import{s as c}from"./supabase-C7rZz57M.js";async function h(e,i,n={}){try{const{data:r,error:s}=await c.auth.signUp({email:e,password:i,options:{data:{display_name:n.username??n.name??null,phone:n.phone??null}}});console.debug("signUp response data:",r),console.debug("signUp response error:",s);const o=r.user;if(o){const{error:a}=await c.from("profiles").insert({id:o.id,username:n.username??null,name:n.name??null,email:o.email??e,phone:n.phone??null});if(a)return console.error("Erro ao criar perfil:",a),!1;console.log("Perfil criado com sucesso")}return!0}catch(r){return console.error("Unexpected signUp error",r),alert("Erro inesperado ao tentar cadastrar. Veja o console para mais detalhes."),!1}}document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("cadastroForm");e&&e.addEventListener("submit",async i=>{i.preventDefault();const n=e.querySelector('input[name="name"]'),r=e.querySelector('input[name="username"]'),s=e.querySelector('input[name="email"]'),o=e.querySelector('input[name="phone"]'),a=e.querySelector('input[name="password"]'),l=e.querySelector('input[name="confirmPassword"]');if(!s||!a||!l){alert("Campos de email ou senha não encontrados no formulário.");return}const m=n?.value.trim()??"",p=r?.value.trim()??"",d=o?.value.trim()??"",u=s.value.trim(),t=a.value,f=l.value;if(!u){alert("Informe um email válido.");return}if(!t||t.length<6){alert("A senha deve ter ao menos 6 caracteres");return}if(t!==f){alert("As senhas não conferem.");return}await h(u,t,{name:m,username:p,phone:d})?(alert("Cadastro realizado com sucesso! Por favor, verifique seu email para confirmar a conta."),window.location.href="/pages/login/login.html"):alert("Não foi possível completar o cadastro. Veja o console para mais detalhes.")})});
