import{s as n}from"./supabase-C7rZz57M.js";import{a as f}from"./guard-SrXEI54j.js";const s=document.getElementById("user-name"),i=document.getElementById("user-fullname"),u=document.getElementById("user-email"),c=document.getElementById("user-phone"),d=document.getElementById("user-bio");async function l(){const{data:e,error:r}=await n.auth.getUser(),o=e?.user;if(r){console.error(r);return}if(!o){f();return}const{data:t,error:a}=await n.from("profiles").select("*").eq("id",o.id).single();if(a){console.error(a);return}s&&(s.innerText=t.username||""),i&&(i.innerText=t.name||""),u&&(u.innerText=t.email||""),c&&(c.innerText=t.phone||""),d&&(d.innerText=t.bio||"")}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{l().catch(e=>console.error("Erro ao carregar dados do usuário:",e))}):l().catch(e=>console.error("Erro ao carregar dados do usuário:",e));const m=document.getElementById("delete-account");async function g(){const{data:e,error:r}=await n.auth.getUser();if(r||!e?.user)throw new Error("Usuário não autenticado.");const o=e.user.id,t=await fetch("/api/delete-user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:o})}),a=await t.json();if(!t.ok)throw new Error(a.error||"Erro ao deletar usuário.");return a}m&&m.addEventListener("click",async e=>{if(e.preventDefault(),confirm("Tem certeza que deseja apagar sua conta? Esta ação é irreversível."))try{await g(),alert("Conta apagada com sucesso!"),window.location.href="../../index.html"}catch(r){const o=r instanceof Error?r.message:String(r);alert("Erro ao apagar conta: "+o),console.log(o)}});
