import{s}from"./supabase-BDK56hxo.js";import{a as d}from"./auth-BpUqCTfN.js";import"./login-ClvyH5aW.js";async function l(){const{data:e,error:t}=await s.from("anuncios").select("id, titulo, sobre, imagens");return t?(console.error("Erro ao buscar livros:",t),[]):e||[]}function u(e){const t=document.createElement("div");t.className="card";const o=document.createElement("img");o.className="card-thumb",o.src=e.imagens&&e.imagens.length>0?e.imagens[0]:"",o.alt=e.titulo;const c=document.createElement("h3");c.textContent=e.titulo;const i=document.createElement("p");i.textContent=e.sobre;const r=document.createElement("button");return r.className="more",r.textContent="Ver mais",r.addEventListener("click",()=>{window.location.href=`../pages/livro/livroPagina.html?id=${e.id}`}),t.appendChild(o),t.appendChild(c),t.appendChild(i),t.appendChild(r),t}async function m(){const e=await l(),t=document.getElementById("cards-grid");t&&(t.innerHTML="",e.forEach(o=>{t.appendChild(u(o))}))}document.addEventListener("DOMContentLoaded",m);const a=document.getElementById("signout-btn"),n=document.getElementById("userArea");h();d();async function h(){try{const{data:e}=await s.auth.getUser();e?.user?(a&&(a.style.display="block"),n&&(n.style.display="block")):(a&&(a.style.display="none"),n&&(n.innerText="Faça login",n.href="../pages/login/login.html"))}catch(e){console.error("Erro ao checar autenticação:",e)}}a&&a.addEventListener("click",async e=>{e.preventDefault();try{const{error:t}=await s.auth.signOut();a&&(a.style.display="none"),n&&(n.innerText="Faça login",n.href="../pages/login/login.html")}catch(t){console.error("Erro no fluxo de signOut:",t),alert("Erro ao sair. Veja o console para detalhes.")}});
